L6BD8:
	EX DE,HL
	LD A,B
	AND $07
	JR NZ,L6BE2

	LD HL,L866B
	DEC (HL)
L6BE2:
	LD (L8643),A
	SRL B
	SRL B
	SRL B
	LD A,C
	AND $07
	ADD A,$40
	BIT 6,C
	JR Z,L6BF6

	ADD A,$08
L6BF6:
	BIT 7,C
	JR Z,L6BFC

	ADD A,$10
L6BFC:
	LD H,A
	LD A,C
	AND $38
	ADD A,A
	ADD A,A
	ADD A,B
	LD L,A
	LD A,(L8643)
	SUB $08
	NEG
	LD B,A
	LD A,$08
	SUB B
	CP $09
	PUSH AF
	LD A,$0B
	JR C,L6C17

	XOR A
L6C17:
	LD (L8669),A
	LD A,$FF
L6C1C:
	ADD A,A
	DJNZ L6C1C

	LD (L865A),A
	POP AF
	JR C,L6C2B

L6C25:
	SUB $08
	CP $09
	JR NC,L6C25

L6C2B:
	LD B,A
	LD A,$FF
L6C2E:
	SRL A
	DJNZ L6C2E

	LD (L8675+1),A
	LD B,$00
L6C37:
	PUSH BC
	PUSH HL
	PUSH HL
	LD C,$01
	LD B,$00
	LD HL,L85AF
	EX DE,HL
	LDIR
	EX DE,HL
	LD (HL),$00
	INC HL
	LD (HL),$00
	LD A,$00
	AND A
	JR Z,L6C61

	LD B,A
	EX AF,AF'
	LD A,B
L6C52:
	LD B,$01
	LD HL,L85AF
L6C57:
	EX AF,AF'
	RR (HL)
	EX AF,AF'
	INC HL
	DJNZ L6C57

	DEC A
	JR NZ,L6C52

L6C61:
	LD A,$00
	POP HL
	LD IX,L85AF
	AND (HL)
	OR (IX+$00)
	LD (HL),A
	INC HL
	INC IX
	JR L6C72

L6C72:
	LD B,$00
L6C74:
	LD A,(IX+$00)
	LD (HL),A
	INC IX
	INC HL
	DJNZ L6C74

	LD A,$00
	AND (HL)
	OR (IX+$00)
	LD (HL),A
	POP HL
	INC H
	LD A,H
	AND $07
	JR NZ,L6C9A

	LD A,L
	CP $E0
	JR NC,L6C96

	LD BC,$F820	; -2016
	ADD HL,BC
	JR L6C9A

L6C96:
	LD A,L
	ADD A,$20
	LD L,A
L6C9A:
	POP BC
	DJNZ L6C37

	RET
